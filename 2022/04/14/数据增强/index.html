<!DOCTYPE HTML>
<html>

<head>
	<link rel="bookmark"  type="image/x-icon"  href="/img/logo_miccall.png"/>
	<link rel="shortcut icon" href="/img/logo_miccall.png">
	
			    <title>
    sleep2hours.github.io
    </title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/css/mic_main.css" />
    <link rel="stylesheet" href="/css/dropdownMenu.css" />
    <meta name="keywords" content="Luo" />
    
    	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	 
    <noscript>
        <link rel="stylesheet" href="/css/noscript.css" />
    </noscript>
    <style type="text/css">
        body:before {
          content: ' ';
          position: fixed;
          top: 0;
          background: url('/img/bg.jpg') center 0 no-repeat;
          right: 0;
          bottom: 0;
          left: 0;
          background-size: cover; 
        }
    </style>

			    
  


    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/main.js"></script>
			
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
        }
      });
    </script>
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
          tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
          }
        });
    </script>
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
            var all = MathJax.Hub.getAllJax(), i;
            for(i=0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>
  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
   
	
<meta name="generator" content="Hexo 5.4.0"></head>
    
		
<!-- Layouts -->



<!--  代码渲染  -->
<link rel="stylesheet" href="/css/prism_coy.css" />
<link rel="stylesheet" href="/css/typo.css" />
<!-- 文章页 -->
<body class="is-loading">
    <!-- Wrapper 外包 s-->
    <div id="wrapper" class="fade-in">
        <!-- Intro 头部显示 s -->
        <!-- Intro 头部显示 e -->
        <!-- Header 头部logo start -->
        <header id="header">
    <a href="/" class="logo">Welcoming!</a>
</header>
        <!-- Nav 导航条 start -->
        <nav id="nav" class="special" >
            <ul class="menu links" >
			<!-- Homepage  主页  --> 
			<li >
	            <a href="/" rel="nofollow">主页</a>
	        </li>
			<!-- categories_name  分类   --> 
	        
	        <li class="active">
	            <a href="#s1">分类</a>
	                    <ul class="submenu">
	                        <li>
	                        <a class="category-link" href="/categories/CV/">CV</a></li><li><a class="category-link" href="/categories/DL/">DL</a></li><li><a class="category-link" href="/categories/cv/">cv</a></li><li><a class="category-link" href="/categories/%E6%95%B0%E5%AD%A6%E6%8E%A8%E5%AF%BC/">数学推导</a></li><li><a class="category-link" href="/categories/%E6%95%B0%E5%AD%A6%E6%A8%A1%E5%9E%8B/">数学模型</a>
	                    </ul>
	        </li>
	        
	        <!-- archives  归档   --> 
	        
	        <li class="active">
	            <a href="#s1">归档</a>
	                    <ul class="submenu">
	                        <li>
	                        <a class="archive-link" href="/archives/2022/04/">April 2022</a></li><li><a class="archive-link" href="/archives/2022/03/">March 2022</a></li><li><a class="archive-link" href="/archives/2022/02/">February 2022</a></li><li><a class="archive-link" href="/archives/2022/01/">January 2022</a></li><li><a class="archive-link" href="/archives/2021/11/">November 2021</a>
	                    </ul>
	        </li>
	        
	        
		        <!-- Pages 自定义   -->
		        
		        <li>
		            <a href="/about/" title="简历">
		                简历
		            </a>
		        </li>
		        
		        <li>
		            <a href="/tag/" title="标签">
		                标签
		            </a>
		        </li>
		        


            </ul>
            <!-- icons 图标   -->
			<ul class="icons">
                    
                    <li>
                        <a title="github" href="https://github.com/sleep2hours" target="_blank" rel="noopener">
                            <i class="icon fa fa-github"></i>
                        </a>
                    </li>
                    
			</ul>
</nav>
        
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
        }
      });
    </script>
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
          tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
          }
        });
    </script>
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
            var all = MathJax.Hub.getAllJax(), i;
            for(i=0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>
  
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
   
        <div id="main" >
            <div class ="post_page_title_img" style="height: 25rem;background-image: url(img/back_aug.jpg);background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;" >
                <a href="#" style="padding: 4rem 4rem 2rem 4rem ;"><h2 >数据增强</h2></a>
            </div>
            <!-- Post -->
            <div class="typo" style="padding: 3rem;">
                <h2 id="Augment"><a href="#Augment" class="headerlink" title="Augment"></a>Augment</h2><h3 id="1-mixup-BEYOND-EMPIRICAL-RISK-MINIMIZATION-ML-2017"><a href="#1-mixup-BEYOND-EMPIRICAL-RISK-MINIMIZATION-ML-2017" class="headerlink" title="1.mixup: BEYOND EMPIRICAL RISK MINIMIZATION(ML 2017)"></a>1.mixup: BEYOND EMPIRICAL RISK MINIMIZATION(ML 2017)</h3><h4 id="1-1Introduction"><a href="#1-1Introduction" class="headerlink" title="1.1Introduction"></a>1.1Introduction</h4><p>以往的模型在学习过程中使用的是ERM，即最小化所有训练数据的平均误差。但是这一方法的泛化能力很差，特别是在测试集的分布与训练集的分布不相同的时候，这时VRM就被提了出来——通过对数据的邻域建模来扩大训练集的分布，比如一张图像的平移、轻微旋转以及微小缩放都可以用来作为这张图像的邻域。将邻域加入到训练集中总而提高模型的泛化能力。但是VRM中图像的邻域和它本身都来自同一类别，对不同类别的图像间的相邻性没有建模。</p>
<p>本文的贡献：在先验知识：数据（feature vectors）的线性组合会引起其目标（one-hot）的线性组合的假设下，引入了以下虚拟数据：<br>$$
x'=\lambda x_i+(1-\lambda)x_j,其中x_i,x_j是输入向量 \\
y'=\lambda y_i+(1-\lambda)y_j,其中y_i,y_j是one-hot label编码
$$</p>
<h4 id="1-2Method"><a href="#1-2Method" class="headerlink" title="1.2Method"></a>1.2Method</h4><p>1.<b>ERM</b>:</p>
<p>在监督学习中，我们会假设输入$x$和标签$y$服从联合分布$P(x,y)$，然后用预测函数$f(x)$来逼近$P(x,y)$。逼近的方法就是最小化$f(x)$和$y$的差异。而最早关于$P(x,y)$的假设是狄拉克（冲激）函数：<br>$$
P_\delta(x,y)=\frac{1}{n}\sum_{i=1}^{n}\delta(x=x_i,y=y_i)
$$<br>即<b>每个输入对应一个输出，整个概率分布是一个个等高的尖峰</b>，这样学出来的东西相当于记住了以往训练集里输入了哪些东西，然后把预测值往这些峰上赶。这样的预测值的不确定性会比较离散，泛化能力差。</p>
<p>2.<b>VRM:</b></p>
<p>为了缓解ERM的尖峰，VRM将$P(x,y)$改为了：<br>$$
P_v(x',y')=\frac{1}{n}\sum_{i=1}^{n}v(x',y'|x_i,y_i)
$$<br>其中$v(x',y'|x_i,y_i)$是$x$的正态分布：<br>$$
v(x',y'|x_i,y_i)=N(x'-x_i,\sigma^2)\delta(y'=y_i)
$$<br>3.<b>mixup:</b></p>
<p>mixup对输入数据和标签（<b>one-hot格式</b>）进行了如下操作：<br>$$
x'=\lambda x_i+(1-\lambda)x_j \\
y'=\lambda y_i+(1-\lambda)y_j
$$<br>其中$\lambda$是从分布$Beta(\alpha,\alpha)$（$\alpha=1$时即为0-1的均匀分布）中采样而得，这样就降低了预测时不确定性的离散型，我参考论文中的图按自己的理解画出了三者的区别：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th><img src="img/1.png" alt="image-20220414122717519" style="zoom:67%;" /></th>
<th><img src="img/2.png" alt="image-20220414122727227" style="zoom:67%;" /></th>
<th><img src="img/3.png" alt="image-20220414122734800" style="zoom:67%;" /></th>
</tr>
</thead>
<tbody>
<tr>
<td>ERM</td>
<td>VRM</td>
<td>mixup</td>
</tr>
</tbody>
</table>
</div>
<p>此外文中提到了：</p>
<ul>
<li>其他的组合比如3-4个组合的输入或是其他更复杂的组合函数并没有提升实验表现反而增加了运算量。</li>
<li>在同一个batch上操作而不是在整个数据集上并不会影响实验表现。</li>
<li>在同一个标签中操作并不会比在不同的标签间进行耦合的效果更好。</li>
<li>一般取$\lambda \epsilon[0.1,0.4]$再大会导致欠拟合，且在图像分类任务中中更大的网络和更长的训练过程效果会更好。</li>
<li>小的权重衰减对mixup会更有用，并且标签平滑loss会降低方法的表现。</li>
</ul>
<hr>
<h3 id="2-CutMix-CVPR-2019"><a href="#2-CutMix-CVPR-2019" class="headerlink" title="2.CutMix(CVPR 2019)"></a>2.CutMix(CVPR 2019)</h3><h4 id="2-1Introduction"><a href="#2-1Introduction" class="headerlink" title="2.1Introduction"></a>2.1Introduction</h4><p>在图像检测、图像分类任务中，卷积神经网络可能会缺少对低辨识度区域的关注，比如人的分类过程中，脸会比腿更加有辨识度，从而导致网络学习到的关于腿的特征更少。因此人们提出了很多数据增强或者正则化方法，比如<b>区域dropout、mixup</b>。</p>
<p>区域Dropout是从输入图像中切去一块儿而用0或者高斯噪声来填充，这导致了输入中多出了许多对特征信息提取没有帮助的像素。而mixup在对输入图像进行加权的过程中，让很多地方变得不自然（比如下图中猫和狗头拼在一起）。因此本文在这两者的基础上提出了新的思路：在一张输入图像上挖去一部分，用另一张输入图像的对应部分来填充，这样就解决了区域dropout的信息缺失问题；同时按照图像拼接的比例来合成label，以此利用mixup在分类时对标签的平滑性。</p>
<center><img src="img/4.png" alt="image-20220414132751492" style="zoom:80%;" /></center>

<center>Figure 1:三种方法的区别，图源原文</center>

<h4 id="2-2Method"><a href="#2-2Method" class="headerlink" title="2.2Method"></a>2.2Method</h4><p>算法的具体实现方法如下：</p>
<p>1.计算出一个0-1掩膜$M$,利用$M$来耦合同一个batch里的两张图像$x_A、x_B$：<br>$$
x'=M\cdot x_A+(1-M)\cdot x_B
\\
y'=\lambda y_A+(1-\lambda y_B)
$$<br>其中，$\lambda$和mixup中一样是取自$Beta(\alpha,\alpha)(\alpha=1)$。</p>
<p>2.掩膜$M$的计算方法如下：</p>
<ul>
<li><p>计算出替换区域$B=(r_x,r_y,r_w,r_h)$，$r_x,r_y$为替换区域左上角坐标，$r_w,r_h$为替换区域的宽和高。</p>
$$
  r_x\epsilon Unif(0,W),r_y\epsilon Unif(0,H)
  \\
  r_w=W\sqrt{1-\lambda},r_h=H\sqrt{1-\lambda}
  $$
<p><b>这样取可以保证在不越界的情况下替换面积与总面积比等于标签比$1-\lambda$</b>。</p>
</li>
<li><p>在$M$中取$B$区域的值为0其他为1。</p>
</li>
</ul>
<center><img src="img/5.png" alt="image-20220414141143990" style="zoom:80%;" /></center>

<center>Figure 2:三个方法的特性总结，图源原文</center>

<hr>

            </div>

            <!-- Post Comments -->
            
    <!-- 使用 DISQUS_CLICK -->
<div id="disqus-comment">
    <div id="disqus_thread"></div>

<!-- add animation -->
<style>
	.disqus_click_btn {
            line-height: 30px;
            margin: 0;
            min-width: 50px;
            padding: 0 14px;
            display: inline-block;
            font-family: "Roboto", "Helvetica", "Arial", sans-serif;
            font-size: 14px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 0;
            overflow: hidden;
            will-change: box-shadow;
            transition: box-shadow .2s cubic-bezier(.4, 0, 1, 1), background-color .2s cubic-bezier(.4, 0, .2, 1), color .2s cubic-bezier(.4, 0, .2, 1);
            outline: 0;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            vertical-align: middle;
            border: 0;
            background: rgba(158, 158, 158, .2);
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .2), 0 1px 5px 0 rgba(0, 0, 0, .12);
            color: #fff;
            background-color: #7EC0EE;
            text-shadow: 0
        }
</style>
	
<div class="btn_click_load" id="disqus_bt"> 
    <button class="disqus_click_btn">点击查看评论</button>
</div>

<!--
<script type="text/javascript">
$('.btn_click_load').click(function() {
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'http-miccall-tech'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    document.getElementById('disqus_bt').style.display = "none";
});
</script>
-->
<script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'http://example.com/2022/04/14/%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'http://example.com/2022/04/14/%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
</script>

<script type="text/javascript">
    $('.btn_click_load').click(function() {  //click to load comments
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document;
            var s = d.createElement('script');
            s.src = '//http-miccall-tech.disqus.com/embed.js';
            s.setAttribute('data-timestamp', + new Date());
            (d.head || d.body).appendChild(s);
        })();
        $('.btn_click_load').css('display','none');
    });
</script>
</div>
<style>
    #disqus-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>


        </div>
        <!-- Copyright 版权 start -->
                <div id="copyright">
            <ul>
                <li>&copy;Powered By <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/" style="border-bottom: none;">hexo</a></li>
                <li>Design: <a target="_blank" rel="noopener" href="http://miccall.tech " style="border-bottom: none;">miccall</a></li>
            </ul>
            
                <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
			
        </div>
    </div>
</body>



 	
</html>
